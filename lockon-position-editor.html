<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lock-On Position Editor</title>
  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: 'Courier New', monospace;
      background: #1a1a1a;
      color: #00ff00;
    }
    
    .container {
      max-width: 600px;
      margin: 0 auto;
    }
    
    h1 {
      text-align: center;
      color: #00ff00;
      text-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
    }
    
    .section {
      background: #0a0a0a;
      border: 2px solid #00ff00;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
    }
    
    label {
      display: block;
      margin-bottom: 5px;
      color: #00ff00;
      font-weight: bold;
    }
    
    select, input {
      width: 100%;
      padding: 10px;
      background: #000;
      border: 1px solid #00ff00;
      color: #00ff00;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      margin-bottom: 15px;
      box-sizing: border-box;
    }
    
    .slider-group {
      margin-bottom: 20px;
    }
    
    .slider-label {
      display: flex;
      justify-content: space-between;
      margin-bottom: 5px;
    }
    
    input[type="range"] {
      width: 100%;
      height: 30px;
      -webkit-appearance: none;
      background: transparent;
    }
    
    input[type="range"]::-webkit-slider-track {
      width: 100%;
      height: 8px;
      background: #003300;
      border: 1px solid #00ff00;
      border-radius: 4px;
    }
    
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      height: 20px;
      width: 20px;
      border-radius: 50%;
      background: #00ff00;
      cursor: pointer;
      margin-top: -6px;
      box-shadow: 0 0 10px rgba(0, 255, 0, 0.8);
    }
    
    input[type="range"]::-moz-range-track {
      width: 100%;
      height: 8px;
      background: #003300;
      border: 1px solid #00ff00;
      border-radius: 4px;
    }
    
    input[type="range"]::-moz-range-thumb {
      height: 20px;
      width: 20px;
      border-radius: 50%;
      background: #00ff00;
      cursor: pointer;
      border: none;
      box-shadow: 0 0 10px rgba(0, 255, 0, 0.8);
    }
    
    .value-display {
      color: #ffff00;
      font-weight: bold;
    }
    
    button {
      width: 100%;
      padding: 15px;
      background: #003300;
      border: 2px solid #00ff00;
      color: #00ff00;
      font-family: 'Courier New', monospace;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      border-radius: 8px;
      margin-bottom: 10px;
      transition: all 0.2s;
    }
    
    button:hover {
      background: #00ff00;
      color: #000;
      box-shadow: 0 0 20px rgba(0, 255, 0, 0.8);
    }
    
    .code-output {
      background: #000;
      border: 1px solid #00ff00;
      padding: 15px;
      border-radius: 4px;
      font-size: 12px;
      white-space: pre;
      overflow-x: auto;
      margin-top: 10px;
    }
    
    .info {
      color: #888;
      font-size: 12px;
      margin-top: 10px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ðŸŽ¯ Lock-On Position Editor</h1>
    
    <div class="section">
      <label for="deviceSelect">Select Interactive Device:</label>
      <select id="deviceSelect">
        <option value="">-- Select Device --</option>
      </select>
    </div>
    
    <div class="section" id="positionSection" style="display: none;">
      <h3>Camera Position</h3>
      
      <div class="slider-group">
        <div class="slider-label">
          <span>Position X:</span>
          <span class="value-display" id="posXValue">0.000</span>
        </div>
        <input type="range" id="posX" min="-2" max="2" step="0.001" value="0">
      </div>
      
      <div class="slider-group">
        <div class="slider-label">
          <span>Position Y:</span>
          <span class="value-display" id="posYValue">0.000</span>
        </div>
        <input type="range" id="posY" min="1" max="3" step="0.001" value="2">
      </div>
      
      <div class="slider-group">
        <div class="slider-label">
          <span>Position Z:</span>
          <span class="value-display" id="posZValue">0.000</span>
        </div>
        <input type="range" id="posZ" min="-2" max="2" step="0.001" value="0">
      </div>
      
      <h3>Camera Rotation</h3>
      
      <div class="slider-group">
        <div class="slider-label">
          <span>Rotation X (Pitch):</span>
          <span class="value-display" id="rotXValue">0.000</span>
        </div>
        <input type="range" id="rotX" min="-0.5" max="0.5" step="0.001" value="0">
      </div>
      
      <div class="slider-group">
        <div class="slider-label">
          <span>Rotation Y (Yaw):</span>
          <span class="value-display" id="rotYValue">0.000</span>
        </div>
        <input type="range" id="rotY" min="0" max="6.28" step="0.001" value="0">
      </div>
      
      <div class="slider-group">
        <div class="slider-label">
          <span>Rotation Z (Roll):</span>
          <span class="value-display" id="rotZValue">0.000</span>
        </div>
        <input type="range" id="rotZ" min="-0.5" max="0.5" step="0.001" value="0">
      </div>
      
      <button onclick="copyToClipboard()">ðŸ“‹ Copy Config to Clipboard</button>
      <button onclick="applyToGame()">ðŸŽ® Apply to Game (Live)</button>
      
      <div class="code-output" id="codeOutput"></div>
      
      <p class="info">Adjust sliders to set camera lock-on position and rotation for the selected device.</p>
    </div>
  </div>

  <script>
    const MACHINES = {
      'computer_audio_machine': {
        displayName: 'Computer & Audio Equipment',
        cameraPosition: { x: 0.20, y: 2.30, z: 0.10 },
        cameraRotation: { x: -0.01, y: 2.38, z: 0 }
      },
      'cube18_machine': {
        displayName: 'Cube18 Equipment (Equalizer)',
        cameraPosition: { x: 0.00, y: 2.20, z: 0.10 },
        cameraRotation: { x: 0.14, y: 2.23, z: 0.00 }
      },
      'computer_monitor': {
        displayName: 'Computer Monitor',
        cameraPosition: { x: 0.15, y: 2.29, z: 0.40 },
        cameraRotation: { x: 0.09, y: 1.58, z: 0.00 }
      }
    };
    
    let currentDevice = null;
    
    // Populate device dropdown
    const deviceSelect = document.getElementById('deviceSelect');
    for (const [key, machine] of Object.entries(MACHINES)) {
      const option = document.createElement('option');
      option.value = key;
      option.textContent = machine.displayName;
      deviceSelect.appendChild(option);
    }
    
    // Device selection handler
    deviceSelect.addEventListener('change', (e) => {
      const deviceId = e.target.value;
      if (!deviceId) {
        document.getElementById('positionSection').style.display = 'none';
        return;
      }
      
      currentDevice = deviceId;
      const machine = MACHINES[deviceId];
      
      // Load values into sliders
      document.getElementById('posX').value = machine.cameraPosition.x;
      document.getElementById('posY').value = machine.cameraPosition.y;
      document.getElementById('posZ').value = machine.cameraPosition.z;
      document.getElementById('rotX').value = machine.cameraRotation.x;
      document.getElementById('rotY').value = machine.cameraRotation.y;
      document.getElementById('rotZ').value = machine.cameraRotation.z;
      
      updateAllDisplays();
      document.getElementById('positionSection').style.display = 'block';
    });
    
    // Slider change handlers
    ['posX', 'posY', 'posZ', 'rotX', 'rotY', 'rotZ'].forEach(id => {
      document.getElementById(id).addEventListener('input', () => {
        updateAllDisplays();
        applyToGameLive();
      });
    });
    
    function updateAllDisplays() {
      // Update value displays with 3 decimal places
      document.getElementById('posXValue').textContent = parseFloat(document.getElementById('posX').value).toFixed(3);
      document.getElementById('posYValue').textContent = parseFloat(document.getElementById('posY').value).toFixed(3);
      document.getElementById('posZValue').textContent = parseFloat(document.getElementById('posZ').value).toFixed(3);
      document.getElementById('rotXValue').textContent = parseFloat(document.getElementById('rotX').value).toFixed(3);
      document.getElementById('rotYValue').textContent = parseFloat(document.getElementById('rotY').value).toFixed(3);
      document.getElementById('rotZValue').textContent = parseFloat(document.getElementById('rotZ').value).toFixed(3);
      
      // Update code output
      updateCodeOutput();
    }
    
    function updateCodeOutput() {
      const posX = parseFloat(document.getElementById('posX').value);
      const posY = parseFloat(document.getElementById('posY').value);
      const posZ = parseFloat(document.getElementById('posZ').value);
      const rotX = parseFloat(document.getElementById('rotX').value);
      const rotY = parseFloat(document.getElementById('rotY').value);
      const rotZ = parseFloat(document.getElementById('rotZ').value);
      
      const code = `// Camera lock-on position
cameraPosition: { x: ${posX.toFixed(3)}, y: ${posY.toFixed(3)}, z: ${posZ.toFixed(3)} },
cameraRotation: { x: ${rotX.toFixed(3)}, y: ${rotY.toFixed(3)}, z: ${rotZ.toFixed(3)} },`;
      
      document.getElementById('codeOutput').textContent = code;
    }
    
    function copyToClipboard() {
      const code = document.getElementById('codeOutput').textContent;
      navigator.clipboard.writeText(code).then(() => {
        alert('âœ“ Config copied to clipboard!');
      });
    }
    
    function applyToGameLive() {
      if (!currentDevice) {
        console.log('No device selected');
        return;
      }
      
      const config = {
        device: currentDevice,
        cameraPosition: {
          x: parseFloat(document.getElementById('posX').value),
          y: parseFloat(document.getElementById('posY').value),
          z: parseFloat(document.getElementById('posZ').value)
        },
        cameraRotation: {
          x: parseFloat(document.getElementById('rotX').value),
          y: parseFloat(document.getElementById('rotY').value),
          z: parseFloat(document.getElementById('rotZ').value)
        }
      };
      
      // Send message to parent window (main game)
      if (window.opener) {
        window.opener.postMessage({
          type: 'updateLockOnPositionLive',
          config: config
        }, '*');
        console.log('Sent live update:', config);
      } else {
        console.warn('No window.opener found');
      }
    }
    
    function applyToGame() {
      if (!currentDevice) return;
      
      const config = {
        device: currentDevice,
        cameraPosition: {
          x: parseFloat(document.getElementById('posX').value),
          y: parseFloat(document.getElementById('posY').value),
          z: parseFloat(document.getElementById('posZ').value)
        },
        cameraRotation: {
          x: parseFloat(document.getElementById('rotX').value),
          y: parseFloat(document.getElementById('rotY').value),
          z: parseFloat(document.getElementById('rotZ').value)
        }
      };
      
      // Send message to parent window (main game)
      if (window.opener) {
        window.opener.postMessage({
          type: 'updateLockOnPosition',
          config: config
        }, '*');
        alert('âœ“ Config sent to game! Lock on to the device to see changes.');
      } else {
        alert('âš  Game window not found. Open this tool from the game using window.openLockOnEditor()');
      }
    }
  </script>
</body>
</html>
