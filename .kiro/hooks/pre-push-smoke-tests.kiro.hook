{
  "enabled": true,
  "name": "Pre-Push Smoke Tests",
  "description": "Monitors code changes and automatically runs targeted smoke tests on modified systems including gameplay loops, player movement, collision detection, and UI interactions. Attempts auto-fixes for common issues and prevents pushes on critical failures.",
  "version": "1",
  "when": {
    "type": "fileEdited",
    "patterns": [
      "**/*.js",
      "**/*.ts",
      "**/*.jsx",
      "**/*.tsx",
      "**/*.py",
      "**/*.cs",
      "**/*.cpp",
      "**/*.h",
      "**/*.java",
      "**/*.go"
    ]
  },
  "then": {
    "type": "askAgent",
    "prompt": "First, check the application health by querying the /status endpoint (typically at http://localhost:5173/status). If the status shows errors or the app is not running, report this immediately. Then analyze the modified files to identify which critical systems were changed (gameplay loops, player movement, collision detection, UI interactions, etc.). Run targeted smoke tests for those specific systems. If tests fail, attempt to automatically fix common issues like import paths, missing dependencies, or configuration problems. If auto-fix fails, prevent the push and generate a detailed error report explaining what failed and why. For critical failures that cannot be auto-fixed, offer to rollback the changes to the last known good state. Provide a summary of all tests run, pass/fail status, and any actions taken."
  }
}